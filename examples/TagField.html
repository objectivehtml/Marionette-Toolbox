<!DOCTYPE html>

<html>
	<head>
		<link rel="stylesheet" href="../resources/bootstrap-3.3.2-dist/css/bootstrap.css">
		<link rel="stylesheet" href="../resources/bootstrap-3.3.2-dist/css/bootstrap-theme.css">
		<link rel="stylesheet" href="../resources/font-awesome-4.3.0/css/font-awesome.css">
		<link rel="stylesheet" href="../dist/marionette.toolbox.css">

		<script src="../resources/vendor.js"></script>

		<script type="text/javascript">
			var $ = require('jquery');
			var _ = require('underscore');
			var Backbone = require('backbone');
			var Radio = require('backbone.radio');
			var Marionette = require('backbone.marionette');
			var Handlebars = require('handlebars');
			var Mousetrap = require('mousetrap');
			var Spinner = require('spin.js');
		</script>

		<script src="../dist/marionette.toolbox.js"></script>
	</head>
	<body>
		<div class="container col-sm-5">
			<div id="app-wrapper"></div>
		</div>

		<script type="text/javascript">
			var App = new Marionette.Application({
				region: '#app-wrapper'
			});

			var UsersCollection = Backbone.Collection.extend({

				url: 'http://toolbox.dev/api/v1/names',

				parse: function(response, options) {
					return response.data;

					var responses = [];

					_.each(response.data, function(row) {
						responses.push(new this.model(response));
					}, this);

					return responses;
				}

			});


			App.on('start', function() {

				var LayoutView = Toolbox.View.extend({
					template: function() {
						return '<div id="field-1"></div><div id="field-2"></div>'
					},
					regions: {
						field1: '#field-1',
						field2: '#field-2'
					},
					onRender: function() {
						var self = this;

						var field1 = new Toolbox.TagField({
							limit: 0,
							name: 'field_name',
							label: 'Field Name (Asynchronous)',
							valueProperty: 'id',
							labelProperty: 'name',
							searchProperty: 'name',
							collection: new UsersCollection,
							ajaxSearch: true,
							multiple: true,
							showResultsOnFocus: false
						});

						this.showChildView('field1', field1);

						var collection = new UsersCollection;

						collection.fetch({
							limit: 20,
							success: function() {

								var field2 = new Toolbox.TagField({
									multiple: true,
									name: 'field_name',
									label: 'Field Name',
									valueProperty: 'id',
									labelProperty: 'name',
									searchProperty: 'name',
									collection: collection,
									showResultsOnFocus: true
								});

								self.showChildView('field2', field2);
							}
						});
					}
				});

				App.showView(new LayoutView);

			});

			App.start();

		</script>

	</body>
</html>
